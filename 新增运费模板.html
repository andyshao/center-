<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>新增运费模板</title>
		<link rel="stylesheet" href="Font/css/font-awesome.min.css" />
		<link rel="stylesheet" href="Font/css/font-awesome-ie7.min.css" />
		<link rel="stylesheet" href="css/bootstrap.css" />
		<link rel="stylesheet" href="css/common.css" />
		<link rel="stylesheet" href="css/sub.css" />
	</head>

	<body>
		<div class="common FreightTemplate TemplateCommon">
			<div class="header">
				<ul>
					<li>
						<a href="" title="首页"><i class="icon-home"></i></a>
					</li>
					<li>
						<a href="" title="我的账户 "><i class="icon-user"></i></a>
					</li>
					<li>
						<a href="" title="修改密码"><i class="icon-lock"></i></a>
					</li>
					<li class="none">
						<a href="" title="退出"><i class="icon-off"></i></a>
					</li>
				</ul>
			</div>
			<!--以上为头部-->
			<div class="menu">
				<div class="title">
					<a href="">企业会员中心！</a>
				</div>
				<ul class="nav nav-stacked " role="navigation">
					<li>
						<a href="#" class="Title toggles" data-toggle="collapse" data-target="#myCollapse">
							<i><img src="images/m1.png" alt="" /></i>
							<span>账户信息</span>
							<i class="icon-angle-down icon "></i>
						</a>
						<div class="collapse" id="myCollapse">
							<ul class=" nav nav-stacked " style="">
								<li>
									<a href="" target="_blank">
										<i><img src="images/m2.png" alt="" /></i>
										<span>我的信息</span>
									</a>
								</li>
								<li>
									<a href="" target="_blank">
										<i><img src="images/m3.png" alt="" /></i>
										<span>修改密码</span>
									</a>
								</li>
								<li>
									<a href="" target="_blank">
										<i><img src="images/m4.png" alt="" /></i>
										<span>发货地址</span>
									</a>
								</li>
								<li>
									<a href="" target="_blank">
										<i><img src="images/m5.png" alt="" /></i>
										<span>合同维护</span>
									</a>
								</li>
								<li>
									<a href="" target="_blank">
										<i><img src="images/m6.png" alt="" /></i>
										<span>商品评论<i class="red">（300条）</i></span>
									</a>
								</li>
								<li>
									<a href="" target="_blank">
										<i><img src="images/m7.png" alt="" /></i>
										<span>账户余额<i class="red">（￥23.00）</i></span>
									</a>
								</li>
								<li>
									<a href="" target="_blank">
										<i><img src="images/m8.png" alt="" /></i>
										<span>提现</span>
									</a>
								</li>
							</ul>
						</div>
					</li>
					<li>
						<a href="#" class="Title toggles" data-toggle="collapse" data-target="#myCollapse2">
							<i><img src="images/m9.png" alt="" /></i>
							<span>商品管理</span>
							<i class="icon-angle-down icon"></i>
						</a>
						<div class="collapse" id="myCollapse2">
							<ul class=" nav nav-stacked">
								<li>
									<a href="" target="_blank">
										<i><img src="images/m10.png" alt="" /></i>
										<span>商品发布</span>
									</a>
								</li>
								<li>
									<a href="" target="_blank">
										<i><img src="images/m11.png" alt="" /></i>
										<span>出售中的商品</span>
									</a>
								</li>
								<li>
									<a href="" target="_blank">
										<i><img src="images/m12.png"/></i>
										<span>仓库中的商品</span>
									</a>
								</li>
							</ul>
						</div>
					</li>
					<li>
						<a href="#" class="Title toggles" data-toggle="collapse" data-target="#myCollapse3">
							<i><img src="images/m13.png" alt="" /></i>
							<span>交易管理</span>
							<i class="icon-angle-down icon"></i>
						</a>
						<div class="collapse" id="myCollapse3">
							<ul class=" nav nav-stacked">
								<li>
									<a href="" target="_blank">
										<i><img src="images/m14.png"/></i>
										<span>退货申请列表</span>
									</a>
								</li>
								<li>
									<a href="" target="_blank">
										<i><img src="images/m15.png" alt="" /></i>
										<span>退换货列表</span>
									</a>
								</li>
								<li>
									<a href="" target="_blank">
										<i><img src="images/m16.png" alt="" /></i>
										<span>卖出订单</span>
									</a>
								</li>
								<li>
									<a href="" target="_blank">
										<i><img src="images/m17.png" alt="" /></i>
										<span>对账单</span>
									</a>
								</li>
							</ul>
						</div>
					</li>
					<li>
						<a href="#" class="Title toggles" data-toggle="collapse" data-target="#myCollapse4">
							<i><img src="images/m18.png" alt="" /></i>
							<span>商铺管理</span>
							<i class="icon-angle-down icon"></i>
						</a>
						<div class="collapse" id="myCollapse4">
							<ul class=" nav nav-stacked">
								<li>
									<a href="" target="_blank">
										<i><img src="images/m19.png"/></i>
										<span>商铺入驻</span>
									</a>
								</li>
								<li>
									<a href="" target="_blank">
										<i><img src="images/m20.png" alt="" /></i>
										<span>加盟商列表</span>
									</a>
								</li>
							</ul>
						</div>
					</li>
					<li>
						<a href="#" class="Title" target="_blank">
							<i><img src="images/m21.png" alt="" /></i>
							<span>营销管理</span>
							<i class="icon icon-angle-right"></i>
						</a>
					</li>
					<li>
						<a href="#" class="Title" target="_blank">
							<i><img src="images/m22.png" alt="" /></i>
							<span>客户管理</span>
							<i class="icon icon-angle-right"></i>
						</a>
					</li>
					<li>
						<a href="#" class="Title" target="_blank">
							<i><img src="images/m23.png" alt="" /></i>
							<span>客户维护</span>
							<i class="icon icon-angle-right"></i>
						</a>
					</li>
				</ul>
			</div>
			<!--以上菜单栏-->
			<div class="Content">
				<div class="container-fluid wrap2">
					<div class="breadcrumb_wrap">
						<ol class="breadcrumb clearfix">
							<li>
								<a href="#">企业会员中心</a>
							</li>
							<li class="active">新增运费模板</li>
						</ol>
					</div>
					<!--以上为面包屑-->
					<div class="Middle">
						<div class="Title">
							<h3>新增运费模板</h3>
						</div>
						<div class="form">
							<form action="">
								<ul class="list-group">
									<li class="list-group-item">
										<div class="listC">
											<span class="Name">模板名称：</span>
											<span class="Message">
										    	<input type="text" class="form-control" placeholder="模板1"/>
										    </span>
										</div>
									</li>
									<li class="list-group-item">
										<div class="listC">
											<span class="Name">商品地区：</span>
											<span class="Message Area" id="Tab">						
												<select id="s1" onchange="getCountry()" class="form-control">
												   <option>请选择国家</option>
												</select>
												<select id="s2" onchange="getProvince()" class="form-control" style="display: none">
													<option>省份、州</option>
												</select>
												<select id="id_provSelect" name="provSelect"  class="form-control"  style="display: none" onChange="getChinaProv(this.value);">
													<option>请选择省份</option>
												</select>
												<select id="s3" style="display: none">
													<option>地级市、县</option>
												</select>
												<select id="id_citySelect" name="citySelect" class="form-control"  style="display: none" onChange="getChinaCity(this.value);">
													<option>请选择城市</option>
												</select>
												<select id="id_areaSelect" name="areaSelect" style="display: none" class="form-control">
													<option>请选择区域</option>
												</select>
										    </span>
										</div>
									</li>
									<li class="list-group-item">
										<div class="listC">
											<span class="Name">发货时间：</span>
											<span class="Message">
										    	<select name="" id="" class="form-control">
										    		<option value="" selected="" disabled="">请选择时间 </option>
										    	</select>
										    </span>
											<p class="Messages">如实设置商品的发货时间，不仅可以避免发货资讯和纠纷，还能促成交易！</p>
										</div>
									</li>
									<li class="list-group-item">
										<div class="listC">
											<span class="Name">是否包邮：</span>
											<span class="Message">
										    	<span class="radios"><input type="radio" id="buyer" name="freight"/><label for="buyer">自定义运费</label></span>
											<span class="radios"><input type="radio" id="seller" name="freight"/><label for="seller">卖家承担运费</label></span>
											</span>
										</div>
									</li>
									<li class="list-group-item">
										<div class="listC">
											<span class="Name">计价方式：</span>
											<span class="Message">
										    	<span class="radios"><input type="radio" id="nums" name=" method"/><label for="nums">按件数</label></span>
											<span class="radios"><input type="radio" id="weights" name=" method"/><label for="weights">按重量</label></span>
											<span class="radios"><input type="radio" id="volumes" name=" method"/><label for="volumes">体积</label></span>
											</span>
										</div>
									</li>
									<li class="list-group-item pm10">
										<div class="listC">
											<span class="Name">运输方式：</span>
											<span class="Message Mder">
										  		  除指定地区外，其余地区的运费采用“默认运费”
											</span>
										</div>
									<div class="DetailWrap">
										<div class="h4 settingDefault"><input type="checkbox" id="express" class="checkStyle"/><label for="express"><i class="icon-check-empty icon"></i>快递</label></div>
										<div class="Detail" style="display:none">
											<div class="Deatil_item">
												<p class="error">注：首费应输入0.00至999.99的数字，续费应输入0.00至999.99的数字</p>
												<div class="promoteNUm">
													<span>默认费用：<input type="text" class="form-control" /> 件内，<input type="text" class="form-control" /> 元；</span>
													<span>每增加：<input type="text" class="form-control" /> 件，增加运费 <input type="text" class="form-control" /> 元；</span>
												</div>
												<div class="TabGroup" style="display:none">
													<div class="Table Table-item" >
														<table border="" cellspacing="" cellpadding="" class="table table-bordered">
															<thead>
																<tr>
																	<th style="width: 30%;">
																		运送到
																	</th>
																	<th>
																		首件（件）
																	</th>
																	<th>首费（元）</th>
																	<th>续件（件）</th>
																	<th>续费（元）</th>
																	<th style="width: 10%;">操作</th>
																</tr>
															</thead>
															<tbody>
															
															</tbody>
														</table>
													</div>
												</div>
												<div class="DeleteGroup" style="display:none">
													<input type="checkbox" class="AllSelected" id="AllSelected">
													<label for="AllSelected">全选</label>
													<a href="javascript:void(0)" class="MoreDelete">批量删除</a>
												</div>
												<div class="addList">
													<a href="javascript:void(0)" class="showTables">为指定地区城市设置运费</a>
													<a href="javascript:void(0)" class="moreAction" style="display:none">批量操作</a>
												</div>
											</div>
										</div>
									</div>
									<div class="DeatilWrap">
										<div class="h4 settingDefault pd10"><input type="checkbox" id="Ems" class="checkStyle"/><label for="Ems"><i class="icon-check-empty icon"></i>Ems</label></div>
										<div class="Detail" style="display:none">
											<div class="Deatil_item">
												<p class="error">注：首费应输入0.00至999.99的数字，续费应输入0.00至999.99的数字</p>
												<div class="promoteNUm">
													<span>默认费用：<input type="text" class="form-control" /> 件内，<input type="text" class="form-control" /> 元；</span>
													<span>每增加：<input type="text" class="form-control" /> 件，增加运费 <input type="text" class="form-control" /> 元；</span>
												</div>
												<div class="TabGroup" style="display:none">
													<div class="Table Table-item">
														<table border="" cellspacing="" cellpadding="" class="table table-bordered">
															<thead>
																<tr>
																	<th style="width: 30%;">
																		运送到
																	</th>
																	<th>
																		首件（件）
																	</th>
																	<th>首费（元）</th>
																	<th>续件（件）</th>
																	<th>续费（元）</th>
																	<th style="width: 10%;">操作</th>
																</tr>
															</thead>
															<tbody>
																
															</tbody>
														</table>
													</div>
												</div>
												<div class="DeleteGroup" style="display:none">
													<input type="checkbox" class="AllSelected" id="AllSelected2">
													<label for="AllSelected2">全选</label>
													<a href="javascript:void(0)" class="MoreDelete">批量删除</a>
												</div>
												<div class="addList">
													<a href="javascript:void(0)" class="showTables">为指定地区城市设置运费</a>
													<a href="javascript:void(0)" class="moreAction" style="display:none">批量操作</a>
												</div>
											</div>
										</div>
									</div>
									<div class="DeatilWrap">
										<div class="h4 settingDefault pd10"><input type="checkbox" id="Mail" class="checkStyle"/><label for="Mail"><i class="icon-check-empty icon"></i>平邮</label></div>
										<div class="Detail" style="display:none">
											<div class="Deatil_item">
												<p class="error">注：首费应输入0.00至999.99的数字，续费应输入0.00至999.99的数字</p>
												<div class="promoteNUm">
													<span>默认费用：<input type="text" class="form-control" /> 件内，<input type="text" class="form-control" /> 元；</span>
													<span>每增加：<input type="text" class="form-control" /> 件，增加运费 <input type="text" class="form-control" /> 元；</span>
												</div>
												<div class="TabGroup" style="display:none">
													<div class="Table Table-item">
														<table border="" cellspacing="" cellpadding="" class="table table-bordered">
															<thead>
																<tr>
																	<th style="width: 30%;">
																		运送到
																	</th>
																	<th>
																		首件（件）
																	</th>
																	<th>首费（元）</th>
																	<th>续件（件）</th>
																	<th>续费（元）</th>
																	<th style="width: 10%;">操作</th>
																</tr>
															</thead>
															<tbody>
																
															</tbody>
														</table>
													</div>
												</div>
												<div class="DeleteGroup" style="display:none">
													<input type="checkbox" class="AllSelected" id="AllSelected3">
													<label for="AllSelected3">全选</label>
													<a href="javascript:void(0)" class="MoreDelete">批量删除</a>
												</div>
												<div class="addList">
													<a href="javascript:void(0)" class="showTables">为指定地区城市设置运费</a>
													<a href="javascript:void(0)" class="moreAction" style="display:none">批量操作</a>
												</div>
											</div>
										</div>
									</div>
									</li>
									<li  class="list-group-item m10 order-package">
										<div class="settingDefault pd10  package"><input type="checkbox" id="special"/><label for="special"><i class="icon-check-empty icon"></i>指定条件包邮</label></div>
										<div class="Detail Mypackpage" style="display:none">
											<div class="Table Table-item">
														<table border="" cellspacing="" cellpadding="" class="table table-bordered">
															<thead>
																<tr>
																	<th style="width: 30%;">
																		选择地区
																	</th>
																	<th>
																		选择运送方式
																	</th>
																	<th>选择快递</th>
																	<th style="width: 20%;">设置包邮条件</th>
																	<th style="width: 10%;">操作</th>
																</tr>
															</thead>
															<tbody>
																<tr>
																	<td><a href='javascript:void(0)' class='Edit'>编辑</a><input type='hidden' class='Ihidden'  id='cityValue"+nth+"'><div class='cityGroup'><p><p></div></td>
																	<td>
																		<select name="" id="" class="form-control"></select>
																	</td>
																	<td></td>
																	<td>
																		<p><select name="" id="" class="form-control"></select></p>
																		<p class="changeContent">满 <input type="text"  class="form-control changeStyle"/> 包邮件</p>
																	</td>
																	<td><a href="javascript:void(0)" class="Delete2">删除</a></td>
																</tr>
															</tbody>
														</table>
												<div class="addList">
													<a href="javascript:void(0)" class="showTable2">为指定地区城市设置运费</a>
												</div>
												<p class="red">优惠方式重复：给同一个地区同一种运送方式设置了不同的优惠方式！</p>
											</div>
										</div>
									</li>
								</ul>
								<div class="buttonGroup">
									<input type="submit" value="保存并返回" class="button_red">
									<input type="reset" value="取消"  class="button_red cancles">
								</div>
							</form>
						</div>
					</div>
					<!-- content -->
				</div>
				<!--编辑地域选择-->
			</div>
		</div>
	</body>
</html>
<script src="js/jquery-1.11.0.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/common.js"></script>
<script type="text/javascript" src="js/TestAddress.js"></script>
<script src="layer/layer.js"></script>
<script type="text/javascript">
$(function(){
	setup();//初始化地域
	Areaints();//运费初始化
})
var s = [ "s1", "s2", "s3" ];
var opt0 = [ "国家", "省份、州", "地级市、县" ];
function setup() {
	change(0);
}
//页面加载完成时执行的初始化
function Areaints(){
	showTable();//增加TR并且显示Table
	deleteTr();//删除TR
	stopMp();//阻止冒泡
	alertBox();//弹出地域选
	MoreAction();//批量操作
}
//每次点击往模板里面插入数据
function showTable(){
	var nth=0;
	$(".showTables").click(function(event) {
		nth++
		var tableGroup=$(this).closest('.addList').siblings(".TabGroup");
		var DeleteGroup=$(this).closest('.addList').siblings(".DeleteGroup");
		var tbody=$(this).closest('.addList').siblings(".TabGroup").find("tbody");
		var tr="<tr data-group="+nth+"><td><input type='checkbox' class='oneCheck left' style='display:none'><a href='javascript:void(0)' class='Edit'>编辑</a><input type='hidden' class='Ihidden'  id='cityValue"+nth+"'><div class='cityGroup'><p><p></div></td><td><input type='text' class='form-control' /></td><td><input type='text' class='form-control' /></td><td><input type='text' class='form-control' /></td><td><input type='text' class='form-control' /></td><td><a href='javascript:void(0)'' class='Delete'>删除</a></td></tr>"
		if(!tableGroup.is(":visible")){
			tableGroup.show();
			tbody.append(tr);
			$(this).siblings('.moreAction').show();
			return
		}else{
			tableGroup.find('tbody').append(tr);
			$(this).siblings('.moreAction').show();
			if(DeleteGroup.is(":visible")){
				tableGroup.find(".oneCheck").show();
			}
			return
		}
	});
}
//删除当前TR
function deleteTr(){
	$(".table").delegate('.Delete', 'click', function(event) {
		var tableGroup=$(this).closest('tr');
		$(this).closest('tr').remove();
		$(".TabGroup").each(function(index, el) {
			var trLength=$(this).find("tbody").find("tr").length;
			if(trLength==0){
				$(this).hide();
				$(this).siblings('.addList').find('.moreAction').hide();
				return
			}
		});
	});
}
//阻止LAbel事件冒泡
function stopMp(){
	$(".dropdown-menu li span").click(function(e){
		e.stopPropagation();
	})
	$(".ks-dialog label").click(function(e){
		e.stopPropagation();
	})
}
//点击后，AJax加载Area页面
function alertBox(){
	$(".table").delegate(".Edit","click",function(){
		var that=$(this);
		$.post('Area.html', {}, function(str){
			  layer.open({
			    type: 1,
			    content: str, //注意，如果str是object，那么需要字符拼接。
			    title:"",
			    area:["600px","580px"],
			    success:function(layero,index){
			    	selectInt(index,that);
			    }
  		});
  	
	});
	})
}
//Area页面加载完成时执行的初始化
function selectInt(index,that){
		AllCheck();
  		stopMp();
  		comfirmAdd(index,that);//添加地域
  		addCookie(that);
  		checkStatus();
  		checkCheck(that); 
  		testVal(that)
}

//如果当前地域已经被选中，那么点击另外一个设置地域时，被选中的地域就不能被操作了
function checkCheck(that){
	var Detail=that.closest(".Detail");
	var hd=Detail.find("input[type='hidden']");
	var arrs=[];
	var vals="";
	var arr="";
	hd.each(function(){
		if($(this).val()!==""){
			arr= $(this).val().split(",");
			for(var i=0;i<arr.length;i++){
				vals+=arr[i]+",";
			}
		}
	})
	if(vals!==""){
		arrs=vals.substring(0,vals.length-1).split(",");
		if(arrs.length){
			for(var i=0;i<arrs.length;i++){
				$(".ks-dialog").find("input[value="+arrs[i]+"]").attr("disabled",true);
			}
		}
	}
	
	$(".dropdown").each(function(){
		var n=$(this).find("input:disabled").length;
		var o=$(this).find("input[type=checkbox]").length;
		if(n==o){
			$(this).siblings(".grates").find(".childCheck").attr("disabled",true)
		}
	})
	$(".city_List").each(function(){
		var n=$(this).find(".grates").find("input:disabled").length;
		var o=$(this).find(".grates").find("input[type=checkbox]").length;
		if(n==o){
			$(this).siblings(".gcity").find(".fatherCheck").prop("disabled",true);
		}
	})
	
}
function testVal(that){
	var val=that.siblings("input[type=hidden]").val();
	if(val.length>0&&val!=""){
		$(".dropdown").find("input:checked").attr("disabled",false)
	}
}
//记录勾选状态
function addCookie(that){
	var value=that.siblings("input[type='hidden']").val();
	if(value){
		var arrs=value.split(",");
		for(var i=0;i<arrs.length;i++){
			$("input[value="+arrs[i]+"]").prop("checked",true);
		}
	}
}
//初始化判断勾选
function checkStatus(){
	$(".dropdown").each(function(){
		var n=$(this).find("input:checked").length;
		var o=$(this).find("input[type=checkbox]").length;
		if(n==o){
			$(this).siblings(".grates").find(".childCheck").prop("checked",true);
//			$(this).siblings(".grates").find(".childCheck").attr("disabled",true);
		}else{
			$(this).siblings(".grates").find(".childCheck").prop("checked",false);
		}
	})
	$(".city_List").each(function(){
		var n=$(this).find(".grates").find("input:checked").length;
		var o=$(this).find(".grates").find("input[type=checkbox]").length;
		if(n==o){
			$(this).siblings(".gcity").find(".fatherCheck").prop("checked",true);
//			$(this).siblings(".gcity").find(".fatherCheck").attr("disabled",true);
		}else{
			$(this).siblings(".gcity").find(".fatherCheck").prop("checked",false);
		}
	})
}
function comfirmAdd(index,that){
	var str="";
	var val="";
	var arr=[];
	$(".addAll").click(function(){
		var check=$(".dropdown").find("input:checked");
		str="";
		arr=[];
		val="";
		if(check.length){
			check.each(function(){
				val=$(this).val();
				str+=$(this).siblings("label").text()+",";
				arr.push(val);
			})
			val=arr.join(",")
			var content=str.substring(0,str.length-1);
			that.siblings(".cityGroup").empty().html(content);
			that.siblings("input[type='hidden']").val(val)
		}
		layer.close(index)
	})
	// 关闭弹出层
	$(".clearAll").click(function(){
		layer.close(index);
	})
}
// 批量操作
function MoreAction(){
	$(".moreAction").click(function(){
		var DeleteGroup=$(this).closest('.addList').siblings('.DeleteGroup');
		var oneCheck=$(this).closest('.addList').siblings('.TabGroup').find(".oneCheck")
		if(DeleteGroup.is(":visible")){
			DeleteGroup.hide();
			oneCheck.hide()
			$(this).text("批量操作");
		}else{
			DeleteGroup.show();
			oneCheck.show();
			$(this).text("取消批量");
		}
	})

// 当前窗口的全选操作
	$(".AllSelected").click(function(){
		 var oneCheck=$(this).closest('.DeleteGroup').siblings('.TabGroup').find(".oneCheck")
		if($(this).is(":checked")){
			oneCheck.prop("checked",true);
		}else{
			oneCheck.prop("checked",false);
		}
	})
	// 删除所有被勾选的元素
	$(".MoreDelete").click(function(event) {
		/* Act on the event */
		var AllSelected=$(this).siblings('.AllSelected');
		var checkD=$(this).closest('.DeleteGroup').siblings('.TabGroup').find(".oneCheck");
		var checkDs=$(this).closest('.DeleteGroup').siblings('.TabGroup').find(".oneCheck:checked")
		var TabGroup=$(this).closest('.DeleteGroup').siblings('.TabGroup');
		if(AllSelected.is(":checked")){
			layer.confirm('确认要删除当前的地域设置吗', {
			  btn: ['确定','取消'] //按钮
			}, function(index){
			 	checkD.closest('tr').remove();
			 	TabGroup.hide();
			 	testMoreAction();
			 	AllSelected.prop("checked",false);
			 	layer.close(index);
			}, function(index){
				 layer.close(index);
			});
		}else if(checkDs.length>0){
			layer.confirm('确认要删除当前的地域设置吗', {
			  btn: ['确定','取消'] //按钮
			}, function(index){
			 	checkDs.closest('tr').remove();
			 	testMoreAction();
			 	layer.close(index);
			}, function(index){
				 layer.close(index);
			});
		}
		else{
			layer.msg('请选择要批量处理的地区');
		}
	});
}
//判断当前的tr的条数是否大于0，如果是就让批量操作显示，不是就隐藏
function testMoreAction(){
	$(".Detail").each(function(){
		var tr=$(this).find("tbody").find("tr");
		if(tr.length>0){
			$(this).find(".moreAction").show();
		}else{
			$(this).find(".moreAction").hide();
			$(this).find(".DeleteGroup").hide()
			$(this).find(".moreAction").text("批量操作");
		}
	})
}

//全选单选
function AllCheck(){
	//父级全选
	$(".group-label").click(function(){
		var checkAll=$(this).find(".fatherCheck");
		if(checkAll.is(":checked")){
			$(this).closest(".gcity").siblings(".city_List").find("input:enabled").prop("checked",true);
		}else{
			$(this).closest(".gcity").siblings(".city_List").find("input[type='checkbox']").prop("checked",false);
		}
		
	})
	//二级全选
	$(".city_List .grates").click(function(){
		var childcheck=$(this).find(".childCheck");
		if(childcheck.is(":checked")){
			$(this).siblings('.dropdown').find("input:enabled").prop("checked",true);
		}else{
			$(this).siblings('.dropdown').find("input[type='checkbox']").prop("checked",false);
		}
		Testcheck();
	})
	//三级全选
	$(".dropdown-menu").find("input[type='checkbox']").click(function(){
		var nc=$(this).closest(".dropdown-menu").find("input[type='checkbox'] ").length;
		var oc=$(this).closest(".dropdown-menu").find("input:checked").length;
		if(nc==oc){
				$(this).closest(".dropdown").siblings(".grates").find(".childCheck").prop("checked",true);
			}else{
				$(this).closest(".dropdown").siblings(".grates").find(".childCheck").prop("checked",false);
			}
		Testcheck();
	})
}
//全选组件
function Testcheck(){
$(".ks_list").each(function(){
	var nc=$(this).find(".childCheck ").length;
	var oc=$(this).find(".childCheck:checked").length;
	var fc=$(this).find(".fatherCheck");
	if(nc==oc){
		fc.prop("checked",true);
	}else{
		fc.prop("checked",false);
	}
	})
}
//判断当前Detail里面的checkbox 全选和单选关联

function RelationCheckOne(){
	$(".TabGroup").delegate(".oneCheck","click",function(){
		var Detail=$(this).closest(".Detail");
		var o=Detail.find(".oneCheck").length;
		var n=Detail.find(".oneCheck:checked").length;
		if(n==o){
			Detail.find(".AllSelected").prop("checked",true);
		}else{
			Detail.find(".AllSelected").prop("checked",false);
		}
	})
}
//复选框样式如果自定义运费被勾选则执行对应事件，否则不执行
function checkBox(){
	var btn=true;
	if($("#buyer").is(":checked")){
		$(".order-package").show()
		$(".checkStyle:checked").closest(".h4").siblings(".Detail").show();
		$(".checkStyle:checked").closest(".h4").css({"border-bottom":"0"});
		$(".settingDefault").find("label").click(function(){
		var chekcbox=$(this).closest(".settingDefault").find("input");
		if(!chekcbox.prop("checked")){
			$(this).find(".icon").addClass("icon-check").removeClass("icon-check-empty");
			$(this).closest('.h4').css({"border-bottom":" 1px solid #F3F5FF"}).siblings('.Detail').show();
			$(this).closest('.package').siblings('.Detail').show();
			chekcbox.prop("checked",false)
		}else{
			$(this).find(".icon").removeClass("icon-check").addClass("icon-check-empty");
			$(this).closest('.h4').css({"border":" 1px solid #768dec"}).siblings('.Detail').hide();	
			$(this).closest('.package').siblings('.Detail').hide();
			chekcbox.prop("checked",true)
		}
	})
	}else{
		$(".order-package").hide();
		$(".checkStyle:checked").closest(".h4").siblings(".Detail").hide();
		$(".checkStyle:checked").closest(".h4").css({"border":" 1px solid #768dec"})
		$(".settingDefault").find("label").click(function(){
		var chekcbox=$(this).closest(".settingDefault").find("input");
		if(!chekcbox.prop("checked")){
			$(this).find(".icon").addClass("icon-check").removeClass("icon-check-empty");
			$(this).closest('.h4').siblings('.Detail').hide();
			$(this).closest('.h4').css({"border":" 1px solid #768dec"})
			chekcbox.prop("checked",false)
		}else{
			$(this).find(".icon").removeClass("icon-check").addClass("icon-check-empty");
			$(this).closest('.h4').css({"border":" 1px solid #768dec"})
			$(this).closest('.h4').siblings('.Detail').hide();
			chekcbox.prop("checked",true)
		}
	})
	}
}
</script>
<script>
// 指定条件包邮JS
$(function(){
	packages();
	pakageIf();
	checkBox()//复选框样式
	RelationCheckOne()//当前页面Detail 全选单选关联
})

function packages(){
	var nth2=0;
	var html=$(".Mypackpage").find("tbody").find("tr").clone(true);
	$(".showTable2").click(function(){
     var str="<tr><td><a href='javascript:void(0)' class='Edit'>编辑</a><input type='hidden' class='Ihidden'  id='cityValue"+nth2+"'><div class='cityGroup'><p><p></div></td><td><input type='text' class='form-control' /></td><td></td><td><p><select name='' id='' class='form-control'></select></p><p class='changeContent'></p></td><td><a href='javascript:void(0)'' class='Delete2'>删除</a></td></tr>"
     $(this).closest('.addList').siblings('table').append(str);
	})
	$(".Mypackpage").delegate('.Delete2', 'click', function(event) {
		$(this).closest('tr').remove()
	});
}
// 指定条件包邮JS
//是否包邮关联
function pakageIf(){
	$("#buyer").click()
	$(".radios").find("input[type='radio']").click(function(){
		checkBox();
	})
}
</script>